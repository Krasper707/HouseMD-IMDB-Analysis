---
title: "House M.D. - An IMDb Data Analysis"
author: "Krasper707"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: united
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
# This first chunk is for setup. It runs but won't be shown in the final report.
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE) # Global options for all chunks

# Load our primary tool for analysis and plotting
library(tidyverse)
library(forcats) # For reordering factors in plots

# Load the clean datasets we created in the previous step
episodes <- read_csv("data/house_md_episodes_clean.csv")
cast <- read_csv("data/house_md_cast_clean.csv")
```

# Introduction

This report analyzes episode data for all 8 seasons of the television show *House M.D.*, scraped from IMDb. The goal is to uncover trends in viewership ratings, identify standout episodes, and explore the show's overall trajectory through the lens of audience reception.

---

# Analysis 1: Average Rating per Season

The most direct way to measure a show's performance over time is to look at the average rating for each season. This can reveal periods of high audience engagement and potential "viewer fatigue" in later years.

```{r rating-by-season-plot}
# Step 1: Calculate the average rating for each season
season_ratings <- episodes %>%
  group_by(season) %>%
  summarize(average_rating = mean(rating, na.rm = TRUE))

# Step 2: Create the plot
ggplot(data = season_ratings, aes(x = factor(season), y = average_rating, fill = average_rating)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = round(average_rating, 2)), vjust = -0.5, size = 3.5) +
  scale_fill_gradient(low = "#e68c8c", high = "#4a86e8") + # Custom red-to-blue gradient
  scale_y_continuous(limits = c(0, 10)) + # Set y-axis from 0 to 10
  labs(
    title = "House M.D. Viewership Fatigue: A Seasonal Decline",
    subtitle = "Average IMDb rating per season shows a clear peak in Season 4, followed by a steady decline.",
    x = "Season",
    y = "Average IMDb Rating",
    caption = "Data Source: IMDb | Analysis by Krasper707"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(color = "gray40"),
    panel.grid.major.x = element_blank() # Remove vertical grid lines
  )
```

**Finding:** The show's ratings peaked in Season 4, which is often cited by fans as one of its strongest. After this peak, there is a consistent, gradual decline in average ratings through the final season, suggesting a drop in audience satisfaction or general series fatigue.

---

# Analysis 2: The Best and Worst Episodes

While seasonal averages tell a broad story, individual episodes can be outliers. Identifying the highest and lowest-rated episodes highlights moments that resonated most (or least) with the audience.

```{r best-worst-episodes-plot}
# Step 1: Find the top 10 best episodes
top_10_episodes <- episodes %>%
  arrange(desc(rating)) %>%
  slice_head(n = 10) %>%
  mutate(type = "Top 10")

# Step 2: Find the bottom 10 worst episodes
bottom_10_episodes <- episodes %>%
  arrange(rating) %>%
  slice_head(n = 10) %>%
  mutate(type = "Bottom 10")

# Step 3: Combine them into one data frame for plotting
best_worst <- bind_rows(top_10_episodes, bottom_10_episodes)

# Step 4: Create the plot
ggplot(data = best_worst, aes(x = rating, y = fct_reorder(title, rating), fill = type)) +
  geom_col() +
  facet_wrap(~type, scales = "free_y") + # Create separate panels for Top and Bottom
  labs(
    title = "The Best and Worst of House M.D.",
    subtitle = "Episodes that hit the mark and those that missed, according to IMDb ratings.",
    x = "IMDb Rating",
    y = "Episode Title"
  ) +
  theme_light() +
  theme(
    legend.position = "none",
    axis.text.y = element_text(size = 8) # Make episode titles smaller
  )
```

**Finding:** The highest-rated episodes are dominated by season finales and pivotal character moments, such as "House's Head" and "Wilson's Heart." Conversely, the lowest-rated episodes are primarily from the later seasons, which aligns with the overall downward trend in seasonal ratings.

---

# Analysis 3: Episode Ratings Over the Entire Series

To see the show's pulse more granularly, we can plot the rating of every single episode in chronological order. This helps visualize volatility and the overall trend from the pilot to the finale.

```{r rating-over-time-plot}
# Step 1: Create an overall episode number
episodes_with_overall_num <- episodes %>%
  arrange(season, episode_num) %>%
  mutate(overall_episode_num = row_number())

# Step 2: Create the plot
ggplot(data = episodes_with_overall_num, aes(x = overall_episode_num, y = rating)) +
  geom_line(color = "gray70", alpha = 0.8) +
  geom_point(alpha = 0.5, size = 1) +
  geom_smooth(method = "loess", se = FALSE, color = "#d9534f", span = 0.2) + # Add a smoothed trendline
  labs(
    title = "The Full Run: Episode-by-Episode IMDb Ratings",
    subtitle = "The red line shows the smoothed trend, highlighting the show's rise, peak, and fall.",
    x = "Overall Episode Number (Chronological)",
    y = "IMDb Rating"
  ) +
  theme_minimal()
```

**Finding:** This detailed view confirms the story from the seasonal analysis. The plot shows an initial rise in ratings , with a slight dip in between ,  through the early seasons, a sustained peak period, and then a clear and steady decline in the latter half of the series' run. The high variance in later seasons also suggests a more inconsistent reception from the audience.

---

# Analysis 4: Who Were the Key Players?

Finally, we can use our cast data to see which actors appeared in the most episodes, giving us a quantitative look at who the core cast members were over the show's entire run.

```{r top-cast-plot}
# Step 1: Count appearances for each actor
actor_appearances <- cast %>%
  count(actor, sort = TRUE) %>%
  slice_head(n = 15) # Get top 15 most frequent actors

# Step 2: Create the plot
ggplot(data = actor_appearances, aes(x = n, y = fct_reorder(actor, n))) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = n), hjust = -0.2, size = 3) +
  labs(
    title = "Most Frequent Cast Members Across All Seasons",
    subtitle = "Episode appearances of the top 15 actors.",
    x = "Number of Episode Appearances",
    y = "Actor"
  ) +
  theme_light()
```

**Finding:** As expected, Hugh Laurie (Dr. House) and Robert Sean Leonard(Wilson) are the only actors to appear in all 176 episodes. The other main characters from the original diagnostic team, along with Dr.Foreman and Dr. Cuddy, round out the top of the list, confirming their central roles in the series.

---

*This concludes the analysis. The data was scraped, cleaned, and visualized using R and the Tidyverse.*